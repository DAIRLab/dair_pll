<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>dair_pll.state_space &mdash; dair_pll v0.0.1 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options.js?v=2fea6348"></script>
        <script src="_static/doctools.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="dair_pll.drake_utils" href="dair_pll.drake_utils.html" />
    <link rel="prev" title="dair_pll.quaternion" href="dair_pll.quaternion.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            dair_pll
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Submodules:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="dair_pll.quaternion.html">dair_pll.quaternion</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">dair_pll.state_space</a></li>
<li class="toctree-l1"><a class="reference internal" href="dair_pll.drake_utils.html">dair_pll.drake_utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="dair_pll.tensor_utils.html">dair_pll.tensor_utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="dair_pll.hyperparameter.html">dair_pll.hyperparameter</a></li>
<li class="toctree-l1"><a class="reference internal" href="dair_pll.data_config.html">dair_pll.data_config</a></li>
<li class="toctree-l1"><a class="reference internal" href="dair_pll.experiment_config.html">dair_pll.experiment_config</a></li>
<li class="toctree-l1"><a class="reference internal" href="dair_pll.file_utils.html">dair_pll.file_utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="dair_pll.inertia.html">dair_pll.inertia</a></li>
<li class="toctree-l1"><a class="reference internal" href="dair_pll.integrator.html">dair_pll.integrator</a></li>
<li class="toctree-l1"><a class="reference internal" href="dair_pll.system.html">dair_pll.system</a></li>
<li class="toctree-l1"><a class="reference internal" href="dair_pll.deep_support_function.html">dair_pll.deep_support_function</a></li>
<li class="toctree-l1"><a class="reference internal" href="dair_pll.geometry.html">dair_pll.geometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="dair_pll.drake_state_converter.html">dair_pll.drake_state_converter</a></li>
<li class="toctree-l1"><a class="reference internal" href="dair_pll.multibody_terms.html">dair_pll.multibody_terms</a></li>
<li class="toctree-l1"><a class="reference internal" href="dair_pll.urdf_utils.html">dair_pll.urdf_utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="dair_pll.drake_system.html">dair_pll.drake_system</a></li>
<li class="toctree-l1"><a class="reference internal" href="dair_pll.vis_utils.html">dair_pll.vis_utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="dair_pll.wandb_manager.html">dair_pll.wandb_manager</a></li>
<li class="toctree-l1"><a class="reference internal" href="dair_pll.multibody_learnable_system.html">dair_pll.multibody_learnable_system</a></li>
<li class="toctree-l1"><a class="reference internal" href="dair_pll.dataset_management.html">dair_pll.dataset_management</a></li>
<li class="toctree-l1"><a class="reference internal" href="dair_pll.experiment.html">dair_pll.experiment</a></li>
<li class="toctree-l1"><a class="reference internal" href="dair_pll.deep_learnable_model.html">dair_pll.deep_learnable_model</a></li>
<li class="toctree-l1"><a class="reference internal" href="dair_pll.deep_learnable_system.html">dair_pll.deep_learnable_system</a></li>
<li class="toctree-l1"><a class="reference internal" href="dair_pll.drake_experiment.html">dair_pll.drake_experiment</a></li>
<li class="toctree-l1"><a class="reference internal" href="bibliography.html">Bibliography</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">dair_pll</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">dair_pll.state_space</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/dair_pll.state_space.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-dair_pll.state_space">
<span id="dair-pll-state-space"></span><h1>dair_pll.state_space<a class="headerlink" href="#module-dair_pll.state_space" title="Link to this heading"></a></h1>
<p>Classes and utilities for operation on Lie group/algebra state spaces.</p>
<p>This module implements a <a class="reference internal" href="#dair_pll.state_space.StateSpace" title="dair_pll.state_space.StateSpace"><code class="xref py py-class docutils literal notranslate"><span class="pre">StateSpace</span></code></a> abstract type which defines
fundamental operations on states in spaces that are not necessarily
Euclidean. In general, we assume configurations spaces are Lie groups,
which together with their associated Lie algebra form a state space. We
implement associated operations on these spaces.</p>
<p>Of note is the <a class="reference internal" href="#dair_pll.state_space.FloatingBaseSpace" title="dair_pll.state_space.FloatingBaseSpace"><code class="xref py py-class docutils literal notranslate"><span class="pre">FloatingBaseSpace</span></code></a>, with configurations in the
Cartesian product of <span class="math notranslate nohighlight">\(SE(3)\)</span> and <span class="math notranslate nohighlight">\(\mathbb{R}^m\)</span>. This space receives
the  particular implementation of representing the <span class="math notranslate nohighlight">\(SO(3)\)</span>
configuration as a quaternion and the Lie algebra velocity/tangent space as
the body-axes angular velocity / rotation vector.</p>
<p>This is also the place where batching dimensions are defined for states. By
convention, the state element index is always the last dimension of the
tensor, and when states are batched in time, time is the second-to-last index.</p>
<dl class="py function">
<dt class="sig sig-object py" id="dair_pll.state_space.partial_sum_batch">
<span class="sig-prename descclassname"><span class="pre">dair_pll.state_space.</span></span><span class="sig-name descname"><span class="pre">partial_sum_batch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">summands</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_batch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dair_pll/state_space.html#partial_sum_batch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dair_pll.state_space.partial_sum_batch" title="Link to this definition"></a></dt>
<dd><p>Sums over a batch, possibly keeping the first batching dimension.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>summands</strong> (<a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>) – <code class="docutils literal notranslate"><span class="pre">(b_1,</span> <span class="pre">...,</span> <span class="pre">b_j,</span> <span class="pre">n_1,</span> <span class="pre">...,</span> <span class="pre">n_k)</span></code> tensor batch of tensors</p></li>
<li><p><strong>keep_batch</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – whether to keep the first batching dimension</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>sum of x as scalar tensor, or <code class="docutils literal notranslate"><span class="pre">(b_1,)</span></code> tensor if
<code class="docutils literal notranslate"><span class="pre">keep_batch</span> <span class="pre">==</span> <span class="pre">True</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dair_pll.state_space.StateSpace">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dair_pll.state_space.</span></span><span class="sig-name descname"><span class="pre">StateSpace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_v</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dair_pll/state_space.html#StateSpace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dair_pll.state_space.StateSpace" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/abc.html#abc.ABC" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></a></p>
<p>Mathematical model of a state space.</p>
<p>Each state space is modeled as the Cartesian product of a connected Lie
group <span class="math notranslate nohighlight">\(G\)</span> and its associated Lie algebra <span class="math notranslate nohighlight">\(\mathfrak g\)</span> (
equivalently up to diffeomorphism, the tangent bundle <span class="math notranslate nohighlight">\(TG\)</span>).
The Lie group element may be given non-minimal coordinates,
e.g. representing SO(3) with quaternions. As <span class="math notranslate nohighlight">\(\mathfrak g\)</span>
is a vector space, <span class="math notranslate nohighlight">\(G \times \mathfrak g\)</span> itself is also a Lie group.</p>
<p>The following assumptions about the group <span class="math notranslate nohighlight">\(G\)</span> and algebra g are made:</p>
<blockquote>
<div><ul class="simple">
<li><p>The Lie group exponential map <span class="math notranslate nohighlight">\(\exp: \mathfrak g \to G\)</span>
is surjective/onto, such that a left inverse
<span class="math notranslate nohighlight">\(\log: G \to \mathfrak g\)</span> can be defined, i.e.
<span class="math notranslate nohighlight">\(\exp(\log(g)) = g\)</span>.</p></li>
<li><p>The Lie group exponential map coincides with the underlying
manifold’s Riemannian geometric exponential map, such that the
geodesic distance from <span class="math notranslate nohighlight">\(g_1\)</span> to <span class="math notranslate nohighlight">\(g_1\)</span> is
<span class="math notranslate nohighlight">\(|\log(g_2 \cdot g_1^{-1})|\)</span></p></li>
</ul>
</div></blockquote>
<p>These conditions are met if and only if <span class="math notranslate nohighlight">\(G\)</span> is the Cartesian
product of a compact group and an Abelian group <span id="id1">[<a class="reference internal" href="bibliography.html#id4" title="John Milnor. Curvatures of left invariant metrics on lie groups. Advances in Mathematics, 21(3):293-329, 1976. URL: https://www.sciencedirect.com/science/article/pii/S0001870876800023, doi:https://doi.org/10.1016/S0001-8708(76)80002-3.">Mil76</a>]</span> – For
example, <span class="math notranslate nohighlight">\(SO(3)\times\mathbb{R}^n\)</span>.</p>
<p>For each concrete class inheriting from <code class="xref py py-class docutils literal notranslate"><span class="pre">StateState</span></code>,
a few fundamental mathematical operators associated with Lie groups must
be defined on these coordinates. <code class="xref py py-class docutils literal notranslate"><span class="pre">StateState</span></code> defines several
other group operations from these units.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_q</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – number of Lie group (configuration) coordinates
(<span class="math notranslate nohighlight">\(&gt;= 0\)</span>)</p></li>
<li><p><strong>n_v</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – number of Lie algebra (velocity) coordinates (<span class="math notranslate nohighlight">\(&gt;= 0\)</span>)</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="dair_pll.state_space.StateSpace.n_q">
<span class="sig-name descname"><span class="pre">n_q</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></em><a class="headerlink" href="#dair_pll.state_space.StateSpace.n_q" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dair_pll.state_space.StateSpace.n_v">
<span class="sig-name descname"><span class="pre">n_v</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></em><a class="headerlink" href="#dair_pll.state_space.StateSpace.n_v" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dair_pll.state_space.StateSpace.n_x">
<span class="sig-name descname"><span class="pre">n_x</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></em><a class="headerlink" href="#dair_pll.state_space.StateSpace.n_x" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dair_pll.state_space.StateSpace.comparisons">
<span class="sig-name descname"><span class="pre">comparisons</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">typing.Dict</span></code></a><span class="pre">[</span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a><span class="pre">,</span> <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">typing.Callable</span></code></a><span class="pre">[[</span><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a><span class="pre">,</span> <a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a><span class="pre">],</span> <a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a><span class="pre">]]</span></em><a class="headerlink" href="#dair_pll.state_space.StateSpace.comparisons" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dair_pll.state_space.StateSpace.configuration_difference">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">configuration_difference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dair_pll/state_space.html#StateSpace.configuration_difference"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dair_pll.state_space.StateSpace.configuration_difference" title="Link to this definition"></a></dt>
<dd><p>Returns the relative transformation between <code class="docutils literal notranslate"><span class="pre">q_1</span></code> and <code class="docutils literal notranslate"><span class="pre">q_2</span></code>.</p>
<p>Specifically, as <span class="math notranslate nohighlight">\(G\)</span> is a Lie group, it has a well-defined inverse
operator. This function returns <span class="math notranslate nohighlight">\(dq = \log(q_2 \cdot q_1^{-1})\)</span>,
i.e. the Lie algebra element such that <span class="math notranslate nohighlight">\(q_1 \exp(dq) = q_2\)</span>.</p>
<p>This method has a corresponding “inverse” function
<a class="reference internal" href="#dair_pll.state_space.StateSpace.exponential" title="dair_pll.state_space.StateSpace.exponential"><code class="xref py py-meth docutils literal notranslate"><span class="pre">exponential()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q_1</strong> (<a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>) – <code class="docutils literal notranslate"><span class="pre">(*,</span> <span class="pre">n_q)</span></code> “starting” configuration, element(s) of Lie
group <span class="math notranslate nohighlight">\(G\)</span>.</p></li>
<li><p><strong>q_2</strong> (<a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>) – <code class="docutils literal notranslate"><span class="pre">(*,</span> <span class="pre">n_q)</span></code> “ending” configuration, element(s) of Lie group
<span class="math notranslate nohighlight">\(G\)</span>.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">(*,</span> <span class="pre">n_v)</span></code> element of Lie algebra g defining the transformation</dt><dd><p>from <code class="docutils literal notranslate"><span class="pre">q_1</span></code> to <code class="docutils literal notranslate"><span class="pre">q_2</span></code></p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dair_pll.state_space.StateSpace.exponential">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">exponential</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dq</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dair_pll/state_space.html#StateSpace.exponential"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dair_pll.state_space.StateSpace.exponential" title="Link to this definition"></a></dt>
<dd><p>Evolves <code class="docutils literal notranslate"><span class="pre">q</span></code> along the Lie group G in the direction <code class="docutils literal notranslate"><span class="pre">dq</span></code>.</p>
<p>This function implements the inverse of
<a class="reference internal" href="#dair_pll.state_space.StateSpace.configuration_difference" title="dair_pll.state_space.StateSpace.configuration_difference"><code class="xref py py-meth docutils literal notranslate"><span class="pre">configuration_difference()</span></code></a> by returning q * exp(dq).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q</strong> (<a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>) – <code class="docutils literal notranslate"><span class="pre">(*,</span> <span class="pre">n_q)</span></code> “starting” configuration, element(s) of Lie group G</p></li>
<li><p><strong>dq</strong> (<a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>) – <code class="docutils literal notranslate"><span class="pre">(*,</span> <span class="pre">n_v)</span></code> perturbation, element(s) of Lie algebra g</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">(*,</span> <span class="pre">n_q)</span></code> group product of q and exp(dq)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dair_pll.state_space.StateSpace.project_configuration">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">project_configuration</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dair_pll/state_space.html#StateSpace.project_configuration"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dair_pll.state_space.StateSpace.project_configuration" title="Link to this definition"></a></dt>
<dd><p>Projects a tensor of size <code class="docutils literal notranslate"><span class="pre">(*,</span> <span class="pre">n_q)</span></code> onto the Lie group G.</p>
<p>This function is used, mostly for numerical stability, to ensure a
<code class="docutils literal notranslate"><span class="pre">(*,</span> <span class="pre">n_q)</span></code> tensor corresponds to Lie group elements. While not
necessarily a Euclidean projection, this function should be:</p>
<blockquote>
<div><ul class="simple">
<li><p>The identity on G, i.e. <code class="docutils literal notranslate"><span class="pre">q</span> <span class="pre">=</span> <span class="pre">projection_configuration(q)</span></code></p></li>
<li><p>Continuous</p></li>
<li><p>(Piecewise) differentiable near G</p></li>
</ul>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>q</strong> (<a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>) – <code class="docutils literal notranslate"><span class="pre">(*,</span> <span class="pre">n_q)</span></code> vectors to project onto G.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">(*,</span> <span class="pre">n_q)</span></code> projection of <code class="docutils literal notranslate"><span class="pre">q</span></code> onto G.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dair_pll.state_space.StateSpace.zero_state">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">zero_state</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/dair_pll/state_space.html#StateSpace.zero_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dair_pll.state_space.StateSpace.zero_state" title="Link to this definition"></a></dt>
<dd><p>Identity element of the Lie group G.</p>
<p>Entitled “zero state” as the group operation is typically thought of
as addition.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">(n_x,)</span></code> tensor group identity</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dair_pll.state_space.StateSpace.q">
<span class="sig-name descname"><span class="pre">q</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dair_pll/state_space.html#StateSpace.q"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dair_pll.state_space.StateSpace.q" title="Link to this definition"></a></dt>
<dd><p>Selects configuration indices from state(s) <code class="docutils literal notranslate"><span class="pre">x</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dair_pll.state_space.StateSpace.v">
<span class="sig-name descname"><span class="pre">v</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dair_pll/state_space.html#StateSpace.v"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dair_pll.state_space.StateSpace.v" title="Link to this definition"></a></dt>
<dd><p>Selects velocity indices from state(s) <code class="docutils literal notranslate"><span class="pre">x</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dair_pll.state_space.StateSpace.q_v">
<span class="sig-name descname"><span class="pre">q_v</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dair_pll/state_space.html#StateSpace.q_v"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dair_pll.state_space.StateSpace.q_v" title="Link to this definition"></a></dt>
<dd><p>Separates state(s) <code class="docutils literal notranslate"><span class="pre">x</span></code> into configuration and velocity</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>, <a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dair_pll.state_space.StateSpace.x">
<span class="sig-name descname"><span class="pre">x</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dair_pll/state_space.html#StateSpace.x"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dair_pll.state_space.StateSpace.x" title="Link to this definition"></a></dt>
<dd><p>Concatenates configuration <code class="docutils literal notranslate"><span class="pre">q</span></code> and velocity <code class="docutils literal notranslate"><span class="pre">v</span></code> into a state</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dair_pll.state_space.StateSpace.config_square_error">
<span class="sig-name descname"><span class="pre">config_square_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_batch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dair_pll/state_space.html#StateSpace.config_square_error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dair_pll.state_space.StateSpace.config_square_error" title="Link to this definition"></a></dt>
<dd><p>Returns squared distance between two Lie group
elements/configurations.</p>
<p>Interprets an <span class="math notranslate nohighlight">\(l_2\)</span>-like error between two configurations as the
square of the geodesic distance between them. This is simply equal to
<span class="math notranslate nohighlight">\(|\log(q_2 \mathrm{inv}(q_1))|^2\)</span> under the assumptions about G.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q_1</strong> (<a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>) – <code class="docutils literal notranslate"><span class="pre">(b_1,</span> <span class="pre">...,</span> <span class="pre">b_k,</span> <span class="pre">n_q)</span></code> “starting” configuration</p></li>
<li><p><strong>q_2</strong> (<a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>) – <code class="docutils literal notranslate"><span class="pre">(b_1,</span> <span class="pre">...,</span> <span class="pre">b_k,</span> <span class="pre">n_q)</span></code> “ending” configuration</p></li>
<li><p><strong>keep_batch</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – whether to keep the outermost batch</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">(b_1,)</span></code> or scalar tensor of squared geodesic distances</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dair_pll.state_space.StateSpace.velocity_square_error">
<span class="sig-name descname"><span class="pre">velocity_square_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_batch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dair_pll/state_space.html#StateSpace.velocity_square_error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dair_pll.state_space.StateSpace.velocity_square_error" title="Link to this definition"></a></dt>
<dd><p>Returns squared distance between two Lie algebra
elements/velocities.</p>
<p>As the Lie algebra is a vector space, the squared error is
interpreted as the geodesic/Euclidean distance</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>v_1</strong> (<a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>) – <code class="docutils literal notranslate"><span class="pre">(b_1,</span> <span class="pre">...,</span> <span class="pre">b_k,</span> <span class="pre">n_v)</span></code> “starting” velocity</p></li>
<li><p><strong>v_2</strong> (<a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>) – <code class="docutils literal notranslate"><span class="pre">(b_1,</span> <span class="pre">...,</span> <span class="pre">b_k,</span> <span class="pre">n_v)</span></code> “ending” velocity</p></li>
<li><p><strong>keep_batch</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – whether to keep the outermost batch</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">(b_1,)</span></code> or scalar tensor of squared geodesic distances.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dair_pll.state_space.StateSpace.state_square_error">
<span class="sig-name descname"><span class="pre">state_square_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_batch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dair_pll/state_space.html#StateSpace.state_square_error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dair_pll.state_space.StateSpace.state_square_error" title="Link to this definition"></a></dt>
<dd><p>Returns squared distance between two states, which are in the
cartesian product G x g.</p>
<p>As g is a vector space, it is Abelian, and thus G x g is the product
of a compact group and an Abelian group. We can then define the
geodesic distance as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dist</span><span class="p">(</span><span class="n">x_1</span><span class="p">,</span> <span class="n">x_2</span><span class="p">)</span><span class="o">^</span><span class="mi">2</span> <span class="o">==</span> <span class="n">dist</span><span class="p">(</span><span class="n">q</span><span class="p">(</span><span class="n">x_1</span><span class="p">),</span> <span class="n">q</span><span class="p">(</span><span class="n">x_2</span><span class="p">))</span><span class="o">^</span><span class="mi">2</span> <span class="o">+</span> <span class="n">dist</span><span class="p">(</span><span class="n">v</span><span class="p">(</span><span class="n">x_1</span><span class="p">),</span> <span class="n">v</span><span class="p">(</span><span class="n">x_2</span><span class="p">))</span><span class="o">^</span><span class="mi">2</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_1</strong> (<a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>) – <code class="docutils literal notranslate"><span class="pre">(b_1,</span> <span class="pre">...,</span> <span class="pre">b_k,</span> <span class="pre">n_x)</span></code> “starting” state</p></li>
<li><p><strong>x_2</strong> (<a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>) – <code class="docutils literal notranslate"><span class="pre">(b_1,</span> <span class="pre">...,</span> <span class="pre">b_k,</span> <span class="pre">n_x)</span></code> “ending” state</p></li>
<li><p><strong>keep_batch</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – whether to keep the outermost batch</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">(b_1,)</span></code> or scalar tensor of squared geodesic distances</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dair_pll.state_space.StateSpace.auxiliary_comparisons">
<span class="sig-name descname"><span class="pre">auxiliary_comparisons</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/dair_pll/state_space.html#StateSpace.auxiliary_comparisons"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dair_pll.state_space.StateSpace.auxiliary_comparisons" title="Link to this definition"></a></dt>
<dd><p>Any additional useful comparisons between pairs of states</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Dict</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>, <a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>], <a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>]]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dair_pll.state_space.StateSpace.finite_difference">
<span class="sig-name descname"><span class="pre">finite_difference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_plus</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dair_pll/state_space.html#StateSpace.finite_difference"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dair_pll.state_space.StateSpace.finite_difference" title="Link to this definition"></a></dt>
<dd><p>Rate of change of configuration</p>
<p>Interprets the rate of change of <code class="docutils literal notranslate"><span class="pre">q</span></code> as an element of the Lie
algebra <code class="docutils literal notranslate"><span class="pre">v</span></code>, such that q_plus == q * exp(v * dt).</p>
<p><a class="reference internal" href="#dair_pll.state_space.StateSpace.finite_difference" title="dair_pll.state_space.StateSpace.finite_difference"><code class="xref py py-meth docutils literal notranslate"><span class="pre">finite_difference()</span></code></a> has a corresponding “inverse” function
<a class="reference internal" href="#dair_pll.state_space.StateSpace.euler_step" title="dair_pll.state_space.StateSpace.euler_step"><code class="xref py py-meth docutils literal notranslate"><span class="pre">euler_step()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q</strong> (<a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>) – <code class="docutils literal notranslate"><span class="pre">(*,</span> <span class="pre">n_q)</span></code> “starting” configuration, element(s) of Lie group G</p></li>
<li><p><strong>q_plus</strong> (<a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>) – <code class="docutils literal notranslate"><span class="pre">(*,</span> <span class="pre">n_q)</span></code> “ending” configuration, element(s) of Lie group G</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) – time difference in [s]</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">(*,</span> <span class="pre">n_v)</span></code> finite-difference velocity, element(s) of Lie algebra g</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dair_pll.state_space.StateSpace.euler_step">
<span class="sig-name descname"><span class="pre">euler_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dair_pll/state_space.html#StateSpace.euler_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dair_pll.state_space.StateSpace.euler_step" title="Link to this definition"></a></dt>
<dd><p>Integrates <code class="docutils literal notranslate"><span class="pre">q</span></code> forward in time given derivative <code class="docutils literal notranslate"><span class="pre">v</span></code>.</p>
<p>Implements the inverse of <a class="reference internal" href="#dair_pll.state_space.StateSpace.finite_difference" title="dair_pll.state_space.StateSpace.finite_difference"><code class="xref py py-meth docutils literal notranslate"><span class="pre">finite_difference()</span></code></a> by returning
q * exp(v * dt), a geodesic forward Euler step.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q</strong> (<a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>) – <code class="docutils literal notranslate"><span class="pre">(*,</span> <span class="pre">n_q)</span></code> “starting” configuration, element(s) of Lie group G</p></li>
<li><p><strong>v</strong> (<a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>) – <code class="docutils literal notranslate"><span class="pre">(*,</span> <span class="pre">n_v)</span></code> “starting” velocity, element(s) of Lie algebra g</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) – time difference in [s]</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">(*,</span> <span class="pre">n_q)</span></code> configuration after Euler step.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dair_pll.state_space.StateSpace.state_difference">
<span class="sig-name descname"><span class="pre">state_difference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dair_pll/state_space.html#StateSpace.state_difference"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dair_pll.state_space.StateSpace.state_difference" title="Link to this definition"></a></dt>
<dd><p>Returns the relative transformation between <code class="docutils literal notranslate"><span class="pre">x_1</span></code> and <code class="docutils literal notranslate"><span class="pre">x_2</span></code></p>
<p>As G x g is a Lie group, we can interpret the difference between two
states via its corresponding Lie algebra, just as in
<a class="reference internal" href="#dair_pll.state_space.StateSpace.configuration_difference" title="dair_pll.state_space.StateSpace.configuration_difference"><code class="xref py py-meth docutils literal notranslate"><span class="pre">configuration_difference()</span></code></a>, as log(x_2 / x_1).</p>
<p><a class="reference internal" href="#dair_pll.state_space.StateSpace.state_difference" title="dair_pll.state_space.StateSpace.state_difference"><code class="xref py py-meth docutils literal notranslate"><span class="pre">state_difference()</span></code></a> has a corresponding “inverse” function
<a class="reference internal" href="#dair_pll.state_space.StateSpace.shift_state" title="dair_pll.state_space.StateSpace.shift_state"><code class="xref py py-meth docutils literal notranslate"><span class="pre">shift_state()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_1</strong> (<a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>) – <code class="docutils literal notranslate"><span class="pre">(*,</span> <span class="pre">n_x)</span></code> “starting” state, element(s) of Lie group G x g</p></li>
<li><p><strong>x_2</strong> (<a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>) – <code class="docutils literal notranslate"><span class="pre">(*,</span> <span class="pre">n_x)</span></code> “ending” state, element(s) of Lie group G x g</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">(*,</span> <span class="pre">n_x)</span></code> element of Lie algebra g x R^n_v defining the
transformation from <code class="docutils literal notranslate"><span class="pre">x_1</span></code> to <code class="docutils literal notranslate"><span class="pre">x_2</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dair_pll.state_space.StateSpace.shift_state">
<span class="sig-name descname"><span class="pre">shift_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dair_pll/state_space.html#StateSpace.shift_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dair_pll.state_space.StateSpace.shift_state" title="Link to this definition"></a></dt>
<dd><p>Evolves <code class="docutils literal notranslate"><span class="pre">x</span></code> along the Lie group G in the direction <code class="docutils literal notranslate"><span class="pre">dx</span></code>.</p>
<p>This function implements the inverse of <a class="reference internal" href="#dair_pll.state_space.StateSpace.state_difference" title="dair_pll.state_space.StateSpace.state_difference"><code class="xref py py-meth docutils literal notranslate"><span class="pre">state_difference()</span></code></a>
by returning q * exp(dq).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>) – <code class="docutils literal notranslate"><span class="pre">(*,</span> <span class="pre">n_x)</span></code> “starting” state, element(s) of Lie group G x g</p></li>
<li><p><strong>dx</strong> (<a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>) – <code class="docutils literal notranslate"><span class="pre">(*,</span> <span class="pre">2</span> <span class="pre">*</span> <span class="pre">n_v)</span></code> perturbation, element(s) of Lie algebra g x R^n_v</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">(*,</span> <span class="pre">n_q)</span></code> group product of q and exp(dq).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dair_pll.state_space.StateSpace.project_state">
<span class="sig-name descname"><span class="pre">project_state</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dair_pll/state_space.html#StateSpace.project_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dair_pll.state_space.StateSpace.project_state" title="Link to this definition"></a></dt>
<dd><p>Projects a tensor of size (*, n_x) onto the state space G x g.</p>
<p>This function has the same basic requirements as
<a class="reference internal" href="#dair_pll.state_space.StateSpace.project_configuration" title="dair_pll.state_space.StateSpace.project_configuration"><code class="xref py py-meth docutils literal notranslate"><span class="pre">project_configuration()</span></code></a> translated to the lie group G x g.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>x</strong> (<a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>) – <code class="docutils literal notranslate"><span class="pre">(*,</span> <span class="pre">n_x)</span></code> vectors to project onto G x g.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">(*,</span> <span class="pre">n_x)</span></code> tensor, projection of <code class="docutils literal notranslate"><span class="pre">x</span></code> onto G x g.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dair_pll.state_space.StateSpace.project_derivative">
<span class="sig-name descname"><span class="pre">project_derivative</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dt</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dair_pll/state_space.html#StateSpace.project_derivative"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dair_pll.state_space.StateSpace.project_derivative" title="Link to this definition"></a></dt>
<dd><p>Changes velocity sequence in <code class="docutils literal notranslate"><span class="pre">x</span></code> to a finite difference.</p>
<p>Extracts configurations q_t from trajectory(ies) and replaces
velocities v_i with <code class="docutils literal notranslate"><span class="pre">finite_difference(q_{i-1},</span> <span class="pre">q_i,</span> <span class="pre">dt)</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>) – <code class="docutils literal notranslate"><span class="pre">(*,</span> <span class="pre">T,</span> <span class="pre">n_x)</span></code> trajectories</p></li>
<li><p><strong>dt</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) – time-step</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">(*,</span> <span class="pre">T,</span> <span class="pre">n_x)</span></code> trajectories with finite-difference velocities.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dair_pll.state_space.FloatingBaseSpace">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dair_pll.state_space.</span></span><span class="sig-name descname"><span class="pre">FloatingBaseSpace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_joints</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dair_pll/state_space.html#FloatingBaseSpace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dair_pll.state_space.FloatingBaseSpace" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#dair_pll.state_space.StateSpace" title="dair_pll.state_space.StateSpace"><code class="xref py py-class docutils literal notranslate"><span class="pre">StateSpace</span></code></a></p>
<p>State space with configurations in SE(3) x R^n_joints.</p>
<p>Called <a class="reference internal" href="#dair_pll.state_space.FloatingBaseSpace" title="dair_pll.state_space.FloatingBaseSpace"><code class="xref py py-class docutils literal notranslate"><span class="pre">FloatingBaseSpace</span></code></a> as it is the state space of an open
kinematic chain with a free-floating base body.</p>
<p>Coordinates for SO(3) are unit quaternions, with remaining states
represented as R^{3 + n_joints}.</p>
<p>Inits <cite>:py:class:`FloatingBaseSpace</cite> of prescribed size.</p>
<p>The floating base has configurations in SE(3), with 4 quaternion + 3
world-axes position configuration coordinates and 3 body-axes angular
velocity + 3 world-axes linear velocity. Each joint is represented as a
single real number.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>n_joints</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – number of joints in chain (&gt;= 0)</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="dair_pll.state_space.FloatingBaseSpace.quat">
<span class="sig-name descname"><span class="pre">quat</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_or_x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dair_pll/state_space.html#FloatingBaseSpace.quat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dair_pll.state_space.FloatingBaseSpace.quat" title="Link to this definition"></a></dt>
<dd><p>select quaternion elements from configuration/state</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dair_pll.state_space.FloatingBaseSpace.base">
<span class="sig-name descname"><span class="pre">base</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_or_x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dair_pll/state_space.html#FloatingBaseSpace.base"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dair_pll.state_space.FloatingBaseSpace.base" title="Link to this definition"></a></dt>
<dd><p>select floating base position elements from configuration/state</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dair_pll.state_space.FloatingBaseSpace.configuration_difference">
<span class="sig-name descname"><span class="pre">configuration_difference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dair_pll/state_space.html#FloatingBaseSpace.configuration_difference"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dair_pll.state_space.FloatingBaseSpace.configuration_difference" title="Link to this definition"></a></dt>
<dd><p>Implements configuration offset for a floating-base rigid chain.</p>
<p>exp() map of SO(3) corresponds to the space of rotation
vectors, or equivalently the matrix group so(3); therefore, the first 3
elements of the return value are body-axes rotation vectors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q_1</strong> (<a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>) – <code class="docutils literal notranslate"><span class="pre">(*,</span> <span class="pre">n_q)</span></code> “starting” configuration in SE(3) x R^n_joints</p></li>
<li><p><strong>q_2</strong> (<a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>) – <code class="docutils literal notranslate"><span class="pre">(*,</span> <span class="pre">n_q)</span></code> “ending” configuration, SE(3) x R^n_joints</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">(*,</span> <span class="pre">n_v)</span></code> body-axes rotation vector, world-axes linear
displacement, and joint offsets.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dair_pll.state_space.FloatingBaseSpace.exponential">
<span class="sig-name descname"><span class="pre">exponential</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dq</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dair_pll/state_space.html#FloatingBaseSpace.exponential"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dair_pll.state_space.FloatingBaseSpace.exponential" title="Link to this definition"></a></dt>
<dd><p>Implements exponential perturbation for a floating-base rigid chain.</p>
<p>This function implements the inverse of <a class="reference internal" href="#dair_pll.state_space.FloatingBaseSpace.configuration_difference" title="dair_pll.state_space.FloatingBaseSpace.configuration_difference"><code class="xref py py-meth docutils literal notranslate"><span class="pre">configuration_difference()</span></code></a>
by rotating <code class="docutils literal notranslate"><span class="pre">quat(q)</span></code> around the body-axis rotation vector in
<code class="docutils literal notranslate"><span class="pre">dq</span></code>, and adding a linear offset to the remaining coordinates.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q</strong> (<a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>) – <code class="docutils literal notranslate"><span class="pre">(*,</span> <span class="pre">n_q)</span></code> “starting” configuration in SE(3) x R^n_joints</p></li>
<li><p><strong>dq</strong> (<a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>) – <code class="docutils literal notranslate"><span class="pre">(*,</span> <span class="pre">n_v)</span></code> perturbation in se(3) x R^n_joints</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">(*,</span> <span class="pre">n_q)</span></code> perturbed quaternion, world-axes floating base origin</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dair_pll.state_space.FloatingBaseSpace.project_configuration">
<span class="sig-name descname"><span class="pre">project_configuration</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dair_pll/state_space.html#FloatingBaseSpace.project_configuration"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dair_pll.state_space.FloatingBaseSpace.project_configuration" title="Link to this definition"></a></dt>
<dd><p>Implements projection onto the floating-base rigid chain
configuration space.</p>
<p>This function projects a <code class="docutils literal notranslate"><span class="pre">(*,</span> <span class="pre">n_q)</span></code> tensor onto SE(3) x R^n_joints by
simply normalizing the quaternion elements.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>q</strong> (<a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>) – <code class="docutils literal notranslate"><span class="pre">(*,</span> <span class="pre">n_q)</span></code> vectors to project onto SE(3) x R^n_joints.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">(*,</span> <span class="pre">n_q)</span></code> tensor, projection of <code class="docutils literal notranslate"><span class="pre">q</span></code> onto SE(3) x R^n_joints.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dair_pll.state_space.FloatingBaseSpace.zero_state">
<span class="sig-name descname"><span class="pre">zero_state</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/dair_pll/state_space.html#FloatingBaseSpace.zero_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dair_pll.state_space.FloatingBaseSpace.zero_state" title="Link to this definition"></a></dt>
<dd><p>Identity element of SE(3) x R^n_joints.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Concatenation of identity quaternion [1, 0, 0, 0] with
<code class="docutils literal notranslate"><span class="pre">(n_joints</span> <span class="pre">+</span> <span class="pre">3)</span></code> zeros.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dair_pll.state_space.FloatingBaseSpace.quaternion_error">
<span class="sig-name descname"><span class="pre">quaternion_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dair_pll/state_space.html#FloatingBaseSpace.quaternion_error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dair_pll.state_space.FloatingBaseSpace.quaternion_error" title="Link to this definition"></a></dt>
<dd><p>Auxiliary comparison that returns floating base orientation geodesic
distance.</p>
<p>Returns a scalar comparison of two floating base rigid chain states
by the angle of rotation between their base orientations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_1</strong> (<a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>) – <code class="docutils literal notranslate"><span class="pre">(*,</span> <span class="pre">n_x)</span></code> “starting” state</p></li>
<li><p><strong>x_2</strong> (<a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>) – <code class="docutils literal notranslate"><span class="pre">(*,</span> <span class="pre">n_x)</span></code> “ending” state</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>scalar tensor, average angle of rotation in batch.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dair_pll.state_space.FloatingBaseSpace.base_error">
<span class="sig-name descname"><span class="pre">base_error</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dair_pll/state_space.html#FloatingBaseSpace.base_error"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dair_pll.state_space.FloatingBaseSpace.base_error" title="Link to this definition"></a></dt>
<dd><p>Auxiliary comparison that returns floating base translation geodesic
distance.</p>
<p>Returns a scalar comparison of two floating base rigid chain states
by the Euclidean between their bases.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_1</strong> (<a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>) – <code class="docutils literal notranslate"><span class="pre">(*,</span> <span class="pre">n_x)</span></code> “starting” state</p></li>
<li><p><strong>x_2</strong> (<a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>) – <code class="docutils literal notranslate"><span class="pre">(*,</span> <span class="pre">n_x)</span></code> “ending” state</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>scalar tensor, average translation in batch.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dair_pll.state_space.FixedBaseSpace">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dair_pll.state_space.</span></span><span class="sig-name descname"><span class="pre">FixedBaseSpace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_joints</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dair_pll/state_space.html#FixedBaseSpace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dair_pll.state_space.FixedBaseSpace" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#dair_pll.state_space.StateSpace" title="dair_pll.state_space.StateSpace"><code class="xref py py-class docutils literal notranslate"><span class="pre">StateSpace</span></code></a></p>
<p>State space with configurations in R^n_joints.</p>
<p>Called <a class="reference internal" href="#dair_pll.state_space.FixedBaseSpace" title="dair_pll.state_space.FixedBaseSpace"><code class="xref py py-class docutils literal notranslate"><span class="pre">FixedBaseSpace</span></code></a> as it is the state space of an open
kinematic chain with fixed base body.</p>
<p>As the Lie group R^n_joints is equivalent to its own algebra, the state
space is simply R^{2 * n_joints}, and the group operation coincides with
addition on this vector space. Thus:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">n_q</span> <span class="o">==</span> <span class="n">n_v</span> <span class="o">==</span> <span class="n">n_x</span><span class="o">/</span><span class="mi">2</span>
</pre></div>
</div>
<p>Inits <a class="reference internal" href="#dair_pll.state_space.FixedBaseSpace" title="dair_pll.state_space.FixedBaseSpace"><code class="xref py py-class docutils literal notranslate"><span class="pre">FixedBaseSpace</span></code></a> of prescribed size.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>n_joints</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a>) – number of joints in chain (&gt;= 0)</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="dair_pll.state_space.FixedBaseSpace.configuration_difference">
<span class="sig-name descname"><span class="pre">configuration_difference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dair_pll/state_space.html#FixedBaseSpace.configuration_difference"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dair_pll.state_space.FixedBaseSpace.configuration_difference" title="Link to this definition"></a></dt>
<dd><p>Implements configuration offset for a fixed-base rigid chain.</p>
<p>In R^n_joints, this is simply vector subtraction.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q_1</strong> (<a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>) – <code class="docutils literal notranslate"><span class="pre">(*,</span> <span class="pre">n_q)</span></code> “starting” configuration in R^n_joints</p></li>
<li><p><strong>q_2</strong> (<a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>) – <code class="docutils literal notranslate"><span class="pre">(*,</span> <span class="pre">n_q)</span></code> “ending” configuration in R^n_joints</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>(*, n_v) difference of configurations</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dair_pll.state_space.FixedBaseSpace.exponential">
<span class="sig-name descname"><span class="pre">exponential</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dq</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dair_pll/state_space.html#FixedBaseSpace.exponential"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dair_pll.state_space.FixedBaseSpace.exponential" title="Link to this definition"></a></dt>
<dd><p>Implements exponential perturbation for a fixed-base rigid chain.</p>
<p>In R^n_joints, this is simply vector addition.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>q</strong> (<a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>) – <code class="docutils literal notranslate"><span class="pre">(*,</span> <span class="pre">n_q)</span></code> “starting” configuration in R^n_joints</p></li>
<li><p><strong>dq</strong> (<a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>) – <code class="docutils literal notranslate"><span class="pre">(*,</span> <span class="pre">n_v)</span></code> perturbation in R^n_joints</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">(*,</span> <span class="pre">n_q)</span></code> perturbed configuration</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dair_pll.state_space.FixedBaseSpace.project_configuration">
<span class="sig-name descname"><span class="pre">project_configuration</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dair_pll/state_space.html#FixedBaseSpace.project_configuration"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dair_pll.state_space.FixedBaseSpace.project_configuration" title="Link to this definition"></a></dt>
<dd><p>Implements projection onto the fixed-base rigid chain
configuration space.</p>
<p>In R^n_joints, this is simply the identity function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>q</strong> (<a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>) – <code class="docutils literal notranslate"><span class="pre">(*,</span> <span class="pre">n_q)</span></code> vectors in R^n_joints.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">(*,</span> <span class="pre">n_q)</span></code> tensor, <code class="docutils literal notranslate"><span class="pre">q</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dair_pll.state_space.FixedBaseSpace.zero_state">
<span class="sig-name descname"><span class="pre">zero_state</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/dair_pll/state_space.html#FixedBaseSpace.zero_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dair_pll.state_space.FixedBaseSpace.zero_state" title="Link to this definition"></a></dt>
<dd><p>Zero element of R^n_x</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dair_pll.state_space.ProductSpace">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dair_pll.state_space.</span></span><span class="sig-name descname"><span class="pre">ProductSpace</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spaces</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dair_pll/state_space.html#ProductSpace"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dair_pll.state_space.ProductSpace" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#dair_pll.state_space.StateSpace" title="dair_pll.state_space.StateSpace"><code class="xref py py-class docutils literal notranslate"><span class="pre">StateSpace</span></code></a></p>
<p>State space constructed as the Cartesian product of subspaces.</p>
<p>The product space conforms with the required properties of our Lie group
as long as each constituent subspace does as well.</p>
<p>Inits <a class="reference internal" href="#dair_pll.state_space.ProductSpace" title="dair_pll.state_space.ProductSpace"><code class="xref py py-class docutils literal notranslate"><span class="pre">ProductSpace</span></code></a> from given factors.</p>
<p>The coordinates of each space in <code class="docutils literal notranslate"><span class="pre">spaces</span></code> are concatenated to
construct the product space’s coordinates, and similar for
the velocities.</p>
<dl class="py method">
<dt class="sig sig-object py" id="dair_pll.state_space.ProductSpace.q_split">
<span class="sig-name descname"><span class="pre">q_split</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dair_pll/state_space.html#ProductSpace.q_split"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dair_pll.state_space.ProductSpace.q_split" title="Link to this definition"></a></dt>
<dd><p>Splits configuration into list of subspace configurations.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dair_pll.state_space.ProductSpace.v_split">
<span class="sig-name descname"><span class="pre">v_split</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">v</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dair_pll/state_space.html#ProductSpace.v_split"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dair_pll.state_space.ProductSpace.v_split" title="Link to this definition"></a></dt>
<dd><p>Splits velocity into list of subspace velocities.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dair_pll.state_space.ProductSpace.x_split">
<span class="sig-name descname"><span class="pre">x_split</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dair_pll/state_space.html#ProductSpace.x_split"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dair_pll.state_space.ProductSpace.x_split" title="Link to this definition"></a></dt>
<dd><p>Splits state into list of subspace states.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">List</span></code></a>[<a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dair_pll.state_space.ProductSpace.configuration_difference">
<span class="sig-name descname"><span class="pre">configuration_difference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">q_2</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dair_pll/state_space.html#ProductSpace.configuration_difference"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dair_pll.state_space.ProductSpace.configuration_difference" title="Link to this definition"></a></dt>
<dd><p>Constructs configuration difference as concatenation of subspace
configuration differences.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dair_pll.state_space.ProductSpace.exponential">
<span class="sig-name descname"><span class="pre">exponential</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dq</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dair_pll/state_space.html#ProductSpace.exponential"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dair_pll.state_space.ProductSpace.exponential" title="Link to this definition"></a></dt>
<dd><p>Constructs perturbed configuration as concatenation of perturbed
subspace configurations</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dair_pll.state_space.ProductSpace.project_configuration">
<span class="sig-name descname"><span class="pre">project_configuration</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">q</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dair_pll/state_space.html#ProductSpace.project_configuration"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dair_pll.state_space.ProductSpace.project_configuration" title="Link to this definition"></a></dt>
<dd><p>Projects configuration onto Lie group by projecting each subspace’s
configuration onto its respective subgroup.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dair_pll.state_space.ProductSpace.zero_state">
<span class="sig-name descname"><span class="pre">zero_state</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/dair_pll/state_space.html#ProductSpace.zero_state"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dair_pll.state_space.ProductSpace.zero_state" title="Link to this definition"></a></dt>
<dd><p>Constructs zero state as concatenation of subspace zeros</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="dair_pll.state_space.centered_uniform">
<span class="sig-prename descclassname"><span class="pre">dair_pll.state_space.</span></span><span class="sig-name descname"><span class="pre">centered_uniform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">size</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dair_pll/state_space.html#centered_uniform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dair_pll.state_space.centered_uniform" title="Link to this definition"></a></dt>
<dd><p>Uniform distribution on zero-centered box [-1, 1]^size</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dair_pll.state_space.WhiteNoiser">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dair_pll.state_space.</span></span><span class="sig-name descname"><span class="pre">WhiteNoiser</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit_noise</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">variance_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dair_pll/state_space.html#WhiteNoiser"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dair_pll.state_space.WhiteNoiser" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Helper class for adding artificial noise to state batches.</p>
<p>Defines an interface for noise distortion of a batch of states. Noise is
modeled as a zero-mean distribution on the Lie algebra of the state space,
<span class="math notranslate nohighlight">\(\mathbb{R}^{2 n_v}\)</span>. Note that this means that velocities receive
noise independent to the configuration, and thus may break the
finite-difference relationship in a trajectory.</p>
<p>Inits a <a class="reference internal" href="#dair_pll.state_space.WhiteNoiser" title="dair_pll.state_space.WhiteNoiser"><code class="xref py py-class docutils literal notranslate"><span class="pre">WhiteNoiser</span></code></a> of specified distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>space</strong> (<a class="reference internal" href="#dair_pll.state_space.StateSpace" title="dair_pll.state_space.StateSpace"><code class="xref py py-class docutils literal notranslate"><span class="pre">StateSpace</span></code></a>) – State space upon which</p></li>
<li><p><strong>unit_noise</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<code class="xref py py-class docutils literal notranslate"><span class="pre">Size</span></code>], <a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>]) – Callback, returns coordinate-independent noise of
nominal unit size.</p></li>
<li><p><strong>variance_factor</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a>) – Variance of a single coordinate’s unit-scale noise.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="dair_pll.state_space.WhiteNoiser.ranges">
<span class="sig-name descname"><span class="pre">ranges</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code></a></em><a class="headerlink" href="#dair_pll.state_space.WhiteNoiser.ranges" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dair_pll.state_space.WhiteNoiser.space">
<span class="sig-name descname"><span class="pre">space</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#dair_pll.state_space.StateSpace" title="dair_pll.state_space.StateSpace"><code class="xref py py-class docutils literal notranslate"><span class="pre">dair_pll.state_space.StateSpace</span></code></a></em><a class="headerlink" href="#dair_pll.state_space.WhiteNoiser.space" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dair_pll.state_space.WhiteNoiser.variance_factor">
<span class="sig-name descname"><span class="pre">variance_factor</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></em><a class="headerlink" href="#dair_pll.state_space.WhiteNoiser.variance_factor" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dair_pll.state_space.WhiteNoiser.noise">
<span class="sig-name descname"><span class="pre">noise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ranges</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">independent</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dair_pll/state_space.html#WhiteNoiser.noise"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dair_pll.state_space.WhiteNoiser.noise" title="Link to this definition"></a></dt>
<dd><p>Adds noise to a given batch of states.</p>
<p>Uses the <code class="docutils literal notranslate"><span class="pre">unit_noise()</span></code> to get. Optionally, adds identical
distortion to each state in the batch, or i.i.d. noise to each state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>) – <code class="docutils literal notranslate"><span class="pre">(*,</span> <span class="pre">space.n_x)</span></code> batch of states to distort with noise.</p></li>
<li><p><strong>ranges</strong> (<a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>) – <code class="docutils literal notranslate"><span class="pre">(2</span> <span class="pre">*</span> <span class="pre">space.n_v,)</span></code> multiplicative scale of noise.</p></li>
<li><p><strong>independent</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">bool</span></code></a>) – whether to independently distort each state.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">(*,</span> <span class="pre">space.n_x)</span></code> distorted batch of states.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dair_pll.state_space.WhiteNoiser.covariance">
<span class="sig-name descname"><span class="pre">covariance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ranges</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dair_pll/state_space.html#WhiteNoiser.covariance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dair_pll.state_space.WhiteNoiser.covariance" title="Link to this definition"></a></dt>
<dd><p>State covariance matrix associated with noise scale.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ranges</strong> (<a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>) – <code class="docutils literal notranslate"><span class="pre">(2</span> <span class="pre">*</span> <span class="pre">space.n_v,)</span></code> multiplicative scale of noise.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">(2</span> <span class="pre">*</span> <span class="pre">space.n_v,</span> <span class="pre">2</span> <span class="pre">*</span> <span class="pre">space.n_v)</span></code> covariance matrix on state space
Lie algebra.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dair_pll.state_space.UniformWhiteNoiser">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dair_pll.state_space.</span></span><span class="sig-name descname"><span class="pre">UniformWhiteNoiser</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">space</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dair_pll/state_space.html#UniformWhiteNoiser"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dair_pll.state_space.UniformWhiteNoiser" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#dair_pll.state_space.WhiteNoiser" title="dair_pll.state_space.WhiteNoiser"><code class="xref py py-class docutils literal notranslate"><span class="pre">WhiteNoiser</span></code></a></p>
<p>Convenience <a class="reference internal" href="#dair_pll.state_space.WhiteNoiser" title="dair_pll.state_space.WhiteNoiser"><code class="xref py py-class docutils literal notranslate"><span class="pre">WhiteNoiser</span></code></a> class for uniform noise.</p>
<p>Inits a <a class="reference internal" href="#dair_pll.state_space.WhiteNoiser" title="dair_pll.state_space.WhiteNoiser"><code class="xref py py-class docutils literal notranslate"><span class="pre">WhiteNoiser</span></code></a> of specified distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>space</strong> (<a class="reference internal" href="#dair_pll.state_space.StateSpace" title="dair_pll.state_space.StateSpace"><code class="xref py py-class docutils literal notranslate"><span class="pre">StateSpace</span></code></a>) – State space upon which</p></li>
<li><p><strong>unit_noise</strong> – Callback, returns coordinate-independent noise of
nominal unit size.</p></li>
<li><p><strong>variance_factor</strong> – Variance of a single coordinate’s unit-scale noise.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dair_pll.state_space.GaussianWhiteNoiser">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dair_pll.state_space.</span></span><span class="sig-name descname"><span class="pre">GaussianWhiteNoiser</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">space</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dair_pll/state_space.html#GaussianWhiteNoiser"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dair_pll.state_space.GaussianWhiteNoiser" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#dair_pll.state_space.WhiteNoiser" title="dair_pll.state_space.WhiteNoiser"><code class="xref py py-class docutils literal notranslate"><span class="pre">WhiteNoiser</span></code></a></p>
<p>Convenience <a class="reference internal" href="#dair_pll.state_space.WhiteNoiser" title="dair_pll.state_space.WhiteNoiser"><code class="xref py py-class docutils literal notranslate"><span class="pre">WhiteNoiser</span></code></a> class for Gaussian noise.</p>
<p>Inits a <a class="reference internal" href="#dair_pll.state_space.WhiteNoiser" title="dair_pll.state_space.WhiteNoiser"><code class="xref py py-class docutils literal notranslate"><span class="pre">WhiteNoiser</span></code></a> of specified distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>space</strong> (<a class="reference internal" href="#dair_pll.state_space.StateSpace" title="dair_pll.state_space.StateSpace"><code class="xref py py-class docutils literal notranslate"><span class="pre">StateSpace</span></code></a>) – State space upon which</p></li>
<li><p><strong>unit_noise</strong> – Callback, returns coordinate-independent noise of
nominal unit size.</p></li>
<li><p><strong>variance_factor</strong> – Variance of a single coordinate’s unit-scale noise.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dair_pll.state_space.StateSpaceSampler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dair_pll.state_space.</span></span><span class="sig-name descname"><span class="pre">StateSpaceSampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">space</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dair_pll/state_space.html#StateSpaceSampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dair_pll.state_space.StateSpaceSampler" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/abc.html#abc.ABC" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ABC</span></code></a></p>
<p>Abstract utility class for sampling on a state space.</p>
<p>Inits <a class="reference internal" href="#dair_pll.state_space.StateSpaceSampler" title="dair_pll.state_space.StateSpaceSampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">StateSpaceSampler</span></code></a> on prescribed space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>space</strong> (<a class="reference internal" href="#dair_pll.state_space.StateSpace" title="dair_pll.state_space.StateSpace"><code class="xref py py-class docutils literal notranslate"><span class="pre">StateSpace</span></code></a>) – State space of sampler.</p>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="dair_pll.state_space.StateSpaceSampler.space">
<span class="sig-name descname"><span class="pre">space</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#dair_pll.state_space.StateSpace" title="dair_pll.state_space.StateSpace"><code class="xref py py-class docutils literal notranslate"><span class="pre">dair_pll.state_space.StateSpace</span></code></a></em><a class="headerlink" href="#dair_pll.state_space.StateSpaceSampler.space" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dair_pll.state_space.StateSpaceSampler.get_sample">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">get_sample</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/dair_pll/state_space.html#StateSpaceSampler.get_sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dair_pll.state_space.StateSpaceSampler.get_sample" title="Link to this definition"></a></dt>
<dd><p>Get sample from state distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(space.n_x,) state sample.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dair_pll.state_space.StateSpaceSampler.covariance">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">covariance</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/dair_pll/state_space.html#StateSpaceSampler.covariance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dair_pll.state_space.StateSpaceSampler.covariance" title="Link to this definition"></a></dt>
<dd><p>Returns covariance of state space distribution.</p>
<p>Interprets the distribution in logarithmic coordinates (the Lie
algebra of the state space), and returns a covariance matrix in
<span class="math notranslate nohighlight">\(\mathbb{R}^{2 n_v \times 2 n_v}\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>(2 * space.n_v, 2 * space.n_v) distribution covariance.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dair_pll.state_space.ConstantSampler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dair_pll.state_space.</span></span><span class="sig-name descname"><span class="pre">ConstantSampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dair_pll/state_space.html#ConstantSampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dair_pll.state_space.ConstantSampler" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#dair_pll.state_space.StateSpaceSampler" title="dair_pll.state_space.StateSpaceSampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">StateSpaceSampler</span></code></a></p>
<p>Convenience <a class="reference internal" href="#dair_pll.state_space.StateSpaceSampler" title="dair_pll.state_space.StateSpaceSampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">StateSpaceSampler</span></code></a> for returning constant
state.</p>
<p>Inits <a class="reference internal" href="#dair_pll.state_space.ConstantSampler" title="dair_pll.state_space.ConstantSampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConstantSampler</span></code></a> with specified constant state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>space</strong> (<a class="reference internal" href="#dair_pll.state_space.StateSpace" title="dair_pll.state_space.StateSpace"><code class="xref py py-class docutils literal notranslate"><span class="pre">StateSpace</span></code></a>) – Sampler’s state space.</p></li>
<li><p><strong>x_0</strong> (<a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>) – <code class="docutils literal notranslate"><span class="pre">(space.n_x,)</span></code> singleton support of underlying probability
distribution.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="dair_pll.state_space.ConstantSampler.space">
<span class="sig-name descname"><span class="pre">space</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#dair_pll.state_space.StateSpace" title="dair_pll.state_space.StateSpace"><code class="xref py py-class docutils literal notranslate"><span class="pre">dair_pll.state_space.StateSpace</span></code></a></em><a class="headerlink" href="#dair_pll.state_space.ConstantSampler.space" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dair_pll.state_space.ConstantSampler.x_0">
<span class="sig-name descname"><span class="pre">x_0</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code></a></em><a class="headerlink" href="#dair_pll.state_space.ConstantSampler.x_0" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dair_pll.state_space.ConstantSampler.get_sample">
<span class="sig-name descname"><span class="pre">get_sample</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/dair_pll/state_space.html#ConstantSampler.get_sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dair_pll.state_space.ConstantSampler.get_sample" title="Link to this definition"></a></dt>
<dd><p>Returns copy of constant <code class="docutils literal notranslate"><span class="pre">x_0</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dair_pll.state_space.ConstantSampler.covariance">
<span class="sig-name descname"><span class="pre">covariance</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/dair_pll/state_space.html#ConstantSampler.covariance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dair_pll.state_space.ConstantSampler.covariance" title="Link to this definition"></a></dt>
<dd><p>Returns zero covariance.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dair_pll.state_space.ZeroSampler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dair_pll.state_space.</span></span><span class="sig-name descname"><span class="pre">ZeroSampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">space</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dair_pll/state_space.html#ZeroSampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dair_pll.state_space.ZeroSampler" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#dair_pll.state_space.ConstantSampler" title="dair_pll.state_space.ConstantSampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConstantSampler</span></code></a></p>
<p>Convenience <a class="reference internal" href="#dair_pll.state_space.ConstantSampler" title="dair_pll.state_space.ConstantSampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConstantSampler</span></code></a> for returning zero state.</p>
<p>Inits <a class="reference internal" href="#dair_pll.state_space.ConstantSampler" title="dair_pll.state_space.ConstantSampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">ConstantSampler</span></code></a> with specified constant state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>space</strong> (<a class="reference internal" href="#dair_pll.state_space.StateSpace" title="dair_pll.state_space.StateSpace"><code class="xref py py-class docutils literal notranslate"><span class="pre">StateSpace</span></code></a>) – Sampler’s state space.</p></li>
<li><p><strong>x_0</strong> – <code class="docutils literal notranslate"><span class="pre">(space.n_x,)</span></code> singleton support of underlying probability
distribution.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dair_pll.state_space.CenteredSampler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dair_pll.state_space.</span></span><span class="sig-name descname"><span class="pre">CenteredSampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ranges</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">unit_noise=&lt;built-in</span> <span class="pre">method</span> <span class="pre">randn</span> <span class="pre">of</span> <span class="pre">type</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_0=None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dair_pll/state_space.html#CenteredSampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dair_pll.state_space.CenteredSampler" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#dair_pll.state_space.StateSpaceSampler" title="dair_pll.state_space.StateSpaceSampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">StateSpaceSampler</span></code></a></p>
<p>State space sampling distribution centered around specified state.</p>
<p>Implemented by sampling the state, and perturbing it with specified white
noise.</p>
<p>Inits <a class="reference internal" href="#dair_pll.state_space.CenteredSampler" title="dair_pll.state_space.CenteredSampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">CenteredSampler</span></code></a> with specified distribution</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>space</strong> (<a class="reference internal" href="#dair_pll.state_space.StateSpace" title="dair_pll.state_space.StateSpace"><code class="xref py py-class docutils literal notranslate"><span class="pre">StateSpace</span></code></a>) – Sampler’s state space.</p></li>
<li><p><strong>ranges</strong> (<a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>) – <code class="docutils literal notranslate"><span class="pre">(2</span> <span class="pre">*</span> <span class="pre">space.n_v,)</span></code> multiplicative scale on noise
distribution standard deviation.</p></li>
<li><p><strong>unit_noise</strong> (<a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Callable" title="(in Python v3.12)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Callable</span></code></a>[[<code class="xref py py-class docutils literal notranslate"><span class="pre">Size</span></code>], <a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>]) – Callback, returns coordinate-independent noise of
nominal unit size.</p></li>
<li><p><strong>x_0</strong> (<a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>) – <code class="docutils literal notranslate"><span class="pre">(space.n_x,)</span></code> center of distribution, around which Lie
algebra perturbation is applied by underlying
<a class="reference internal" href="#dair_pll.state_space.WhiteNoiser" title="dair_pll.state_space.WhiteNoiser"><code class="xref py py-class docutils literal notranslate"><span class="pre">WhiteNoiser</span></code></a>.</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="dair_pll.state_space.CenteredSampler.variance_factor">
<span class="sig-name descname"><span class="pre">variance_factor</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.12)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></em><a class="headerlink" href="#dair_pll.state_space.CenteredSampler.variance_factor" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dair_pll.state_space.CenteredSampler.x_0">
<span class="sig-name descname"><span class="pre">x_0</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code></a></em><a class="headerlink" href="#dair_pll.state_space.CenteredSampler.x_0" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="dair_pll.state_space.CenteredSampler.ranges">
<span class="sig-name descname"><span class="pre">ranges</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">torch.Tensor</span></code></a></em><a class="headerlink" href="#dair_pll.state_space.CenteredSampler.ranges" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dair_pll.state_space.CenteredSampler.get_sample">
<span class="sig-name descname"><span class="pre">get_sample</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/dair_pll/state_space.html#CenteredSampler.get_sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dair_pll.state_space.CenteredSampler.get_sample" title="Link to this definition"></a></dt>
<dd><p>Returns <code class="docutils literal notranslate"><span class="pre">x_0</span></code> distorted by white noise.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="dair_pll.state_space.CenteredSampler.covariance">
<span class="sig-name descname"><span class="pre">covariance</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/dair_pll/state_space.html#CenteredSampler.covariance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dair_pll.state_space.CenteredSampler.covariance" title="Link to this definition"></a></dt>
<dd><p>Returns covariance of underlying noiser.</p>
<dl class="field-list simple">
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dair_pll.state_space.UniformSampler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dair_pll.state_space.</span></span><span class="sig-name descname"><span class="pre">UniformSampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">space</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ranges</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dair_pll/state_space.html#UniformSampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dair_pll.state_space.UniformSampler" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#dair_pll.state_space.CenteredSampler" title="dair_pll.state_space.CenteredSampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">CenteredSampler</span></code></a></p>
<p>Convenience <a class="reference internal" href="#dair_pll.state_space.CenteredSampler" title="dair_pll.state_space.CenteredSampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">CenteredSampler</span></code></a> for uniform noise.</p>
<p>Inits <a class="reference internal" href="#dair_pll.state_space.CenteredSampler" title="dair_pll.state_space.CenteredSampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">CenteredSampler</span></code></a> with specified distribution</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>space</strong> (<a class="reference internal" href="#dair_pll.state_space.StateSpace" title="dair_pll.state_space.StateSpace"><code class="xref py py-class docutils literal notranslate"><span class="pre">StateSpace</span></code></a>) – Sampler’s state space.</p></li>
<li><p><strong>ranges</strong> (<a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>) – <code class="docutils literal notranslate"><span class="pre">(2</span> <span class="pre">*</span> <span class="pre">space.n_v,)</span></code> multiplicative scale on noise
distribution standard deviation.</p></li>
<li><p><strong>unit_noise</strong> – Callback, returns coordinate-independent noise of
nominal unit size.</p></li>
<li><p><strong>x_0</strong> (<a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a>) – <code class="docutils literal notranslate"><span class="pre">(space.n_x,)</span></code> center of distribution, around which Lie
algebra perturbation is applied by underlying
<a class="reference internal" href="#dair_pll.state_space.WhiteNoiser" title="dair_pll.state_space.WhiteNoiser"><code class="xref py py-class docutils literal notranslate"><span class="pre">WhiteNoiser</span></code></a>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="dair_pll.state_space.GaussianSampler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">dair_pll.state_space.</span></span><span class="sig-name descname"><span class="pre">GaussianSampler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dair_pll/state_space.html#GaussianSampler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#dair_pll.state_space.GaussianSampler" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="#dair_pll.state_space.CenteredSampler" title="dair_pll.state_space.CenteredSampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">CenteredSampler</span></code></a></p>
<p>Convenience <a class="reference internal" href="#dair_pll.state_space.CenteredSampler" title="dair_pll.state_space.CenteredSampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">CenteredSampler</span></code></a> for Gaussian noise.</p>
<p>Inits <a class="reference internal" href="#dair_pll.state_space.CenteredSampler" title="dair_pll.state_space.CenteredSampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">CenteredSampler</span></code></a> with specified distribution</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>space</strong> – Sampler’s state space.</p></li>
<li><p><strong>ranges</strong> – <code class="docutils literal notranslate"><span class="pre">(2</span> <span class="pre">*</span> <span class="pre">space.n_v,)</span></code> multiplicative scale on noise
distribution standard deviation.</p></li>
<li><p><strong>unit_noise</strong> – Callback, returns coordinate-independent noise of
nominal unit size.</p></li>
<li><p><strong>x_0</strong> – <code class="docutils literal notranslate"><span class="pre">(space.n_x,)</span></code> center of distribution, around which Lie
algebra perturbation is applied by underlying
<a class="reference internal" href="#dair_pll.state_space.WhiteNoiser" title="dair_pll.state_space.WhiteNoiser"><code class="xref py py-class docutils literal notranslate"><span class="pre">WhiteNoiser</span></code></a>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="dair_pll.quaternion.html" class="btn btn-neutral float-left" title="dair_pll.quaternion" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="dair_pll.drake_utils.html" class="btn btn-neutral float-right" title="dair_pll.drake_utils" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Mathew Halm &amp; DAIR Lab.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>